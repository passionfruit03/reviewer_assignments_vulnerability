import json

class AttackDataset:
    def __init__(self, attacks_path, start=0, end=None):
        self.path = attacks_path
        self.start = start
        self.end = end

    def __iter__(self):
        with open(self.path, 'r') as f:
            for i, line in enumerate(f):
                if (i < self.start):
                    continue
                if (self.end is not None and i >= self.end):
                    break
                attack_instance = json.loads(line)
                yield i, attack_instance

if __name__ == "__main__":
    dataset = AttackDataset("/data/peer-review/nips22/most_similar_attacks_r101.jsonl")
    for instance in dataset:
        print(instance)
        input()